<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Leaderboard</title>
<style>
  body { font-family: Arial; background: #eef; }
  .container { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; }
  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  td, th { border: 1px solid #ccc; padding: 8px; text-align: center; }
</style>
</head>
<body>
<div class="container">
  <h1>üèÜ Leaderboard</h1>

  <table id="leaderboardTable">
    <tr>
      <th>Rank</th><th>Name</th><th>Score</th><th>Coins</th>
    </tr>
  </table>

  <p><button onclick="backHome()">üè† Back Home</button></p>
</div>

<script>
let leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
let player = JSON.parse(localStorage.getItem("player") || '{"name":"Player","coins":0}');

// Prevent duplicate names: update if exists, else add
let found = false;
for (let i = 0; i < leaderboard.length; i++) {
  if (leaderboard[i].name.trim().toLowerCase() === player.name.trim().toLowerCase()) {
    leaderboard[i].score = player.score || leaderboard[i].score || 0;
    leaderboard[i].coins = player.coins || leaderboard[i].coins || 0;
    found = true;
    break;
  }
}
if (!found) {
  leaderboard.push({
    name: player.name,
    score: player.score || 0,
    coins: player.coins || 0
  });
}

// Sort: first by coins (desc), then by score (desc)
leaderboard.sort((a, b) => {
  if ((b.coins || 0) !== (a.coins || 0)) {
    return (b.coins || 0) - (a.coins || 0);
  }
  return (b.score || 0) - (a.score || 0);
});

// Save updated leaderboard
localStorage.setItem("leaderboard", JSON.stringify(leaderboard));

function renderBoard() {
  const medals = ["ü•á#1", "ü•à#2", "ü•â#3"];
  const tbl = document.getElementById("leaderboardTable");
  tbl.innerHTML = `<tr><th>Rank</th><th>Name</th><th>Score</th><th>Coins</th></tr>`;
  leaderboard.forEach((p, i) => {
    const tr = document.createElement("tr");
    let rankDisplay = i < 3 ? medals[i] : `#${i+1}`;
    tr.innerHTML = `
      <td>${rankDisplay}</td>
      <td>${p.name}</td>
      <td>${p.score || 0}</td>
      <td>${p.coins || 0}</td>
    `;
    tbl.appendChild(tr);
  });
}

function backHome() {
  window.location.href = "index.html";
}

// Listen for storage changes (e.g., coins spent in another tab)
window.addEventListener("storage", function(e) {
  if (e.key === "player" || e.key === "leaderboard") {
    location.reload();
  }
});

renderBoard();
</script>
</body>
</html>
<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: linear-gradient(120deg, #7b2eff 0%, #6e18b0 100%);
    min-height: 100vh;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .container {
    max-width: 600px;
    margin: 40px auto;
    background: rgba(255,255,255,0.18);
    box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);
    backdrop-filter: blur(12px);
    border-radius: 18px;
    border: 1.5px solid rgba(255,255,255,0.28);
    padding: 32px 24px 24px 24px;
  }
  h1 {
    color: #000000;
    text-shadow: 0 0 12px #09090999;
    margin-bottom: 24px;
    font-size: 2.2em;
    letter-spacing: 1px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    background: rgba(255,255,255,0.85);
    border-radius: 10px;
    overflow: hidden;
  }
  td, th {
    border: 1px solid #b3d1ff;
    padding: 10px;
    text-align: center;
    font-size: 1.1em;
  }
  th {
    background: #005bea;
    color: #fff;
    font-weight: bold;
    letter-spacing: 1px;
  }
  tr:nth-child(even) td {
    background: #eaf6ff;
  }
  tr:nth-child(odd) td {
    background: #f7fbff;
  }
  button {
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    background: linear-gradient(90deg, #6911b0a9  0%, #b7251e87 100%);
    color: #fff;
    font-weight: bold;
    font-size: 1em;
    cursor: pointer;
    box-shadow: 0 2px 8px #2193b055;
    transition: background 0.2s, transform 0.1s;
  }
  button:hover {
    background: linear-gradient(90deg, #5ae00ca7 0%, #d8a10a76 100%);
    transform: scale(1.04);
  }
</style>
